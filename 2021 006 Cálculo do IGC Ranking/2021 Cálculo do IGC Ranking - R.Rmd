---
title: "2021 Cálculo do IGC Ranking"
output: html_document
---
# PROBLEMA
Calcular a posição do ranking da Universidade Federal do Triângulo Mineiro (UFTM) no IGC (O Índice Geral de Cursos é um dos instrumentos utilizados para conhecer o desempenho das instituições de ensino superior do Brasil. O instrumento é construído com base numa média ponderada das notas dos cursos de graduação e pós-graduação de cada instituição.)

# DATASET
https://www.gov.br/inep/pt-br/acesso-a-informacao/dados-abertos/indicadores-educacionais/indicadores-de-qualidade-da-educacao-superior


```{r}
library(readxl)
library(dplyr)

library(ggplot2)
library(ggcorrplot)
```


```{r}
dados <- read_excel("IGC_2019.xlsx")
dados <- as.data.frame(dados)
```

```{r}
colnames(dados)
```
```{r}
rownames(dados)[1:20]
```
```{r}
dim(dados)
```
```{r}
str(dados)
```
```{r}
glimpse(dados)
```

```{r}
sapply(dados, function(x) length(unique(x)))
```
```{r}
summary(dados)
```
```{r}
sapply(dados, function(x) sum(is.na(x)))
```
```{r}
sapply(dados, function(x) sum(is.null(x)))
```
```{r paged.print=FALSE}
head(dados, 5)
```

```{r paged.print=FALSE}
tail(dados)
```

```{r paged.print=FALSE}
sample_n(dados, 5)
```

```{r}
dim(dados[is.na(dados$`IGC (Contínuo)`), ])
```
```{r}
dados[is.na(dados$`IGC (Contínuo)`), ]
```

```{r}
dados <- dados[!is.na(dados$`IGC (Contínuo)`), ]
```

```{r}
ggplot(dados) + 
  aes(x = `IGC (Contínuo)`) + 
  geom_histogram()
```
```{r}
ggplot(dados) + 
  aes(x = `IGC (Contínuo)`) + 
  geom_boxplot()
```

```{r paged.print=FALSE}
filtro <- dados %>% 
  group_by(`Sigla da UF`) %>%  
  summarise( media = mean(`IGC (Contínuo)`)) %>% 
  arrange(media)


levels <- filtro$`Sigla da UF`
filtro$`Sigla da UF` <- factor(filtro$`Sigla da UF`, levels=levels, ordered=TRUE)

filtro
```


```{r}
filtro %>%
  ggplot(aes(x = `Sigla da UF`, y = media)) +
  geom_col()
```

```{r}
ggplot(dados, aes(x = `IGC (Contínuo)`, y = `Sigla da UF`)) +
  geom_boxplot()
```

```{r paged.print=FALSE}
filtro <- dados %>% 
  group_by(`Categoria Administrativa`) %>%  
  summarise( media = mean(`IGC (Contínuo)`)) %>% 
  arrange(media)


levels <- filtro$`Categoria Administrativa`
filtro$`Categoria Administrativa` <- factor(filtro$`Categoria Administrativa`, 
                                            levels=levels, ordered=TRUE)

filtro
```


```{r}
filtro %>%
  ggplot(aes(x = `Categoria Administrativa`, y = media)) +
  geom_col()
```

```{r}
ggplot(dados, aes(x = `IGC (Contínuo)`, y = `Categoria Administrativa`)) +
  geom_boxplot()
```

```{r paged.print=FALSE}
filtro <- dados %>% 
  group_by(`Organização Acadêmica`) %>%  
  summarise( media = mean(`IGC (Contínuo)`)) %>% 
  arrange(media)


levels <- filtro$`Organização Acadêmica`
filtro$`Organização Acadêmica` <- factor(filtro$`Organização Acadêmica`, 
                                            levels=levels, ordered=TRUE)

filtro
```

```{r}
filtro %>%
  ggplot(aes(x = `Organização Acadêmica`, y = media)) +
  geom_col()
```

```{r}
ggplot(dados, aes(x = `IGC (Contínuo)`, y = `Organização Acadêmica`)) +
  geom_boxplot()
```

```{r}
ggplot(dados, aes(x = `Organização Acadêmica`)) +
  geom_bar()
```

```{r}

colunas <- c("Nº de Cursos com CPC no triênio",            
"Alfa (Proporção de Graduação)",                
"Conceito Médio de Graduação",                  
"Beta (Proporção de Mestrado - Equivalente)",   
"Conceito Médio de Mestrado",                   
"Gama (Proporção de Doutorandos – Equivalente)",
"Conceito Médio do doutorado",                  
"IGC (Contínuo)",                               
"IGC (Faixa)" )

for (cl in colunas){
  dados[cl] <- as.double(dados[, cl])
}

cor(dados[, colunas])
```


```{r}
ggcorrplot(cor(dados[, colunas]))
```



```{r}
ranking <- function(dados, coluna, parametros){
  
  filtro <- dados[dados[, coluna] %in% parametros, ]
  filtro <- filtro %>% arrange(desc(`IGC (Contínuo)` ))
  
  media <- mean(filtro$`IGC (Contínuo)`)
  linha <- which(filtro$`Código da IES` == 597)
  nota <- filtro[linha, 'IGC (Contínuo)']
  
  return(c(media, nota, linha))
}
```

```{r paged.print=FALSE}
v1 <- ranking(dados,'Categoria Administrativa', c('Pública Federal') )
v2 <- ranking(dados,'Categoria Administrativa', c('Pública Federal', 'Pública Estadual', 'Pública Municipal') )

resultado <- data.frame(rbind(v1, v2))
colnames(resultado) <- c('Média', 'Nota', 'Posição')
rownames(resultado) <- c('Pública Federal', 'Públicas')
resultado
```

```{r paged.print=FALSE}

ddf = dados[which(dados$`Categoria Administrativa` == 'Pública Federal'),]

v1 <- ranking(ddf,'Sigla da UF', c('MG') )
v2 <- ranking(ddf,'Sigla da UF', c('MG', 'SP', 'RJ', 'ES') )
v3 <- ranking(ddf,'Sigla da UF', c(unique(ddf$`Sigla da UF`)) )

resultado <- data.frame(rbind(v1, v2, v3))
colnames(resultado) <- c('Média', 'Nota', 'Posição')
rownames(resultado) <- c('Estadual', 'Região', 'Brasil')
resultado
```

```{r paged.print=FALSE}
v1 <- ranking(dados,'Sigla da UF', c('MG') )
v2 <- ranking(dados,'Sigla da UF', c('MG', 'SP', 'RJ', 'ES') )
v3 <- ranking(dados,'Sigla da UF', c(unique(dados$`Sigla da UF`)) )

resultado <- data.frame(rbind(v1, v2, v3))
colnames(resultado) <- c('Média', 'Nota', 'Posição')
rownames(resultado) <- c('Estadual', 'Região', 'Brasil')
resultado
```

