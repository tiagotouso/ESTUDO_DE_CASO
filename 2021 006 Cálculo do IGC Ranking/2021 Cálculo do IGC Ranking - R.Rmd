---
title: "2021 Cálculo do IGC Ranking"
output: html_notebook
---

# PROBLEMA
Calcular a posição do ranking da Universidade Federal do Triângulo Mineiro (UFTM) no IGC (O Índice Geral de Cursos é um dos instrumentos utilizados para conhecer o desempenho das instituições de ensino superior do Brasil. O instrumento é construído com base numa média ponderada das notas dos cursos de graduação e pós-graduação de cada instituição.)

# DATASET
https://www.gov.br/inep/pt-br/acesso-a-informacao/dados-abertos/indicadores-educacionais/indicadores-de-qualidade-da-educacao-superior

CARREGAR OS MÓDULOS
```{r}
library(readxl)
library(dplyr)

library(ggplot2)
library(ggcorrplot)
```

CARREGAR O DATASET
```{r}
dados <- read_excel("IGC_2019.xlsx")
dados <- as.data.frame(dados)
```

VERIFICAR O NOME DAS COLUNAS DO DATASET
```{r}
colnames(dados)
```

VERIFICAR O NOME DAS LINHAS
```{r}
rownames(dados)[1:20]
```

VERIFICAR O TAMANHA DO DATASET
```{r}
dim(dados)
```

VERIFICAR OS TIPOS DE DADOS DO DATASET
```{r}
str(dados)
```

VERIFICAR OS TIPOS DE DADOS DO DATASET
```{r}
glimpse(dados)
```

VERIFICAR A QUANTIDADE DE VALORES ÚNICOS
```{r}
sapply(dados, function(x) length(unique(x)))
```

VERIFICAR O RESUMO DO DATASET
```{r}
summary(dados)
```

VERIFICAR A QUANTIDADE DE VALORES MISSING
```{r}
sapply(dados, function(x) sum(is.na(x)))
```

VERIFICAR A QUANTIDADE DE VALORES NULOS
```{r}
sapply(dados, function(x) sum(is.null(x)))
```

VERIFICAR AS PRIMEIRAS LINHAS DO DATASET
```{r paged.print=FALSE}
head(dados, 5)
```

VERIFICAR AS ÚLTIMAS LINHAS DO DATASET
```{r paged.print=FALSE}
tail(dados)
```

VERIFIAR VALORES ALEATÓRIOS DO DATASET
```{r paged.print=FALSE}
sample_n(dados, 5)
```

VERIFICAR A QUANTIDADE DE VALORES MISSING DA VARIÁVEL
```{r}
dim(dados[is.na(dados$`IGC (Contínuo)`), ])
```

VERIFICAR OS REGISTROS QUE TEM VALORES MISSING
```{r paged.print=FALSE}
dados[is.na(dados$`IGC (Contínuo)`), ]
```

EXCLUIR OS REGISTROS COM VALORES MISSING
```{r}
dados <- dados[!is.na(dados$`IGC (Contínuo)`), ]
```

PLOTAR HISTROGRAMA
```{r}
ggplot(dados) + 
  aes(x = `IGC (Contínuo)`) + 
  geom_histogram()
```

PLOTAR BOXPLOT
```{r}
ggplot(dados) + 
  aes(x = `IGC (Contínuo)`) + 
  geom_boxplot()
```

VERIFICAR A MÉDIA POR UF
```{r paged.print=FALSE}
filtro <- dados %>% 
  group_by(`Sigla da UF`) %>%  
  summarise( media = mean(`IGC (Contínuo)`)) %>% 
  arrange(media)


levels <- filtro$`Sigla da UF`
filtro$`Sigla da UF` <- factor(filtro$`Sigla da UF`, levels=levels, ordered=TRUE)

filtro
```

PLOTAR A MÉDIA POR UF
```{r}
filtro %>%
  ggplot(aes(x = `Sigla da UF`, y = media)) +
  geom_col()
```

PLOTAR O BOXPLOT POR UF
```{r}
ggplot(dados, aes(x = `IGC (Contínuo)`, y = `Sigla da UF`)) +
  geom_boxplot()
```

VERIFICAR A MÉDIA POR CATEGORIA ADM
```{r paged.print=FALSE}
filtro <- dados %>% 
  group_by(`Categoria Administrativa`) %>%  
  summarise( media = mean(`IGC (Contínuo)`)) %>% 
  arrange(media)


levels <- filtro$`Categoria Administrativa`
filtro$`Categoria Administrativa` <- factor(filtro$`Categoria Administrativa`, 
                                            levels=levels, ordered=TRUE)

filtro
```

PLOTAR A MÉDIA POR CATEGORIA ADM
```{r}
filtro %>%
  ggplot(aes(x = `Categoria Administrativa`, y = media)) +
  geom_col()
```

PLOTAR O BOXPLOT POR CATEGORIA ADM
```{r}
ggplot(dados, aes(x = `IGC (Contínuo)`, y = `Categoria Administrativa`)) +
  geom_boxplot()
```

VERIFICAR A MÉDIA POR ORGANIZAÇÃO ACADÊMICA
```{r paged.print=FALSE}
filtro <- dados %>% 
  group_by(`Organização Acadêmica`) %>%  
  summarise( media = mean(`IGC (Contínuo)`)) %>% 
  arrange(media)


levels <- filtro$`Organização Acadêmica`
filtro$`Organização Acadêmica` <- factor(filtro$`Organização Acadêmica`, 
                                            levels=levels, ordered=TRUE)

filtro
```

PLOTAR A MÉDIA POR ORGANIZAÇÃO ACADÊMICA
```{r}
filtro %>%
  ggplot(aes(x = `Organização Acadêmica`, y = media)) +
  geom_col()
```

PLOTAR O BOXPLOT POR ORGANIZAÇÃO ACADÊMICA
```{r}
ggplot(dados, aes(x = `IGC (Contínuo)`, y = `Organização Acadêmica`)) +
  geom_boxplot()
```

PLOTAR A QUANTIDADE DE ORGANIZAÇÃO ACADÊMICA
```{r}
ggplot(dados, aes(x = `Organização Acadêmica`)) +
  geom_bar()
```

CONVERTER AS VARIÁVEIS DE TEXTO PARA NUMÉRICO
```{r}

colunas <- c("Nº de Cursos com CPC no triênio",            
"Alfa (Proporção de Graduação)",                
"Conceito Médio de Graduação",                  
"Beta (Proporção de Mestrado - Equivalente)",   
"Conceito Médio de Mestrado",                   
"Gama (Proporção de Doutorandos – Equivalente)",
"Conceito Médio do doutorado",                  
"IGC (Contínuo)",                               
"IGC (Faixa)" )

for (cl in colunas){
  dados[cl] <- as.double(dados[, cl])
}

cor(dados[, colunas])
```

PLOTAR AS CORRELAÇÕES
```{r}
ggcorrplot(cor(dados[, colunas]))
```

CRIAR A FUNÇÃO PARA CRIAR O RANKING
```{r}
ranking <- function(dados, coluna, parametros){
  "FUNÇÃO PARA CRIAR O RANKING
  ENTRA
    DATASET, COLUNA E OS PARAMETROS PARA FILTRO
  SAI
    A MEDIA, NOTA E O RANKING"
  
  filtro <- dados[dados[, coluna] %in% parametros, ]
  filtro <- filtro %>% arrange(desc(`IGC (Contínuo)` ))
  
  media <- mean(filtro$`IGC (Contínuo)`)
  linha <- which(filtro$`Código da IES` == 597)
  nota <- filtro[linha, 'IGC (Contínuo)']
  
  return(c(media, nota, linha))
}
```

CRIAR O RANKING POR CATEGORIA
```{r paged.print=FALSE}
v1 <- ranking(dados,'Categoria Administrativa', c('Pública Federal') )
v2 <- ranking(dados,'Categoria Administrativa', c('Pública Federal', 'Pública Estadual', 'Pública Municipal') )

resultado <- data.frame(rbind(v1, v2))
colnames(resultado) <- c('Média', 'Nota', 'Posição')
rownames(resultado) <- c('Pública Federal', 'Públicas')
resultado
```

CRIAR O RANKING POR UF E CATEGORIA ADMINISTRATIVA
```{r paged.print=FALSE}

ddf = dados[which(dados$`Categoria Administrativa` == 'Pública Federal'),]

v1 <- ranking(ddf,'Sigla da UF', c('MG') )
v2 <- ranking(ddf,'Sigla da UF', c('MG', 'SP', 'RJ', 'ES') )
v3 <- ranking(ddf,'Sigla da UF', c(unique(ddf$`Sigla da UF`)) )

resultado <- data.frame(rbind(v1, v2, v3))
colnames(resultado) <- c('Média', 'Nota', 'Posição')
rownames(resultado) <- c('Estadual', 'Região', 'Brasil')
resultado
```

CRIAR O RANKING POR UF
```{r paged.print=FALSE}
v1 <- ranking(dados,'Sigla da UF', c('MG') )
v2 <- ranking(dados,'Sigla da UF', c('MG', 'SP', 'RJ', 'ES') )
v3 <- ranking(dados,'Sigla da UF', c(unique(dados$`Sigla da UF`)) )

resultado <- data.frame(rbind(v1, v2, v3))
colnames(resultado) <- c('Média', 'Nota', 'Posição')
rownames(resultado) <- c('Estadual', 'Região', 'Brasil')
resultado
```
